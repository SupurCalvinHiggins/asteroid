------------------------------------------------------------------
-- bitwise.ast
--
-- this module defines bitwise operations
--
------------------------------------------------------------------

------------------------------------------------------------------
function bitwise_and
------------------------------------------------------------------
with(x:%integer, y:%integer) do return escape
"
global __retval__
x_val = state.symbol_table.lookup_sym('x')
y_val = state.symbol_table.lookup_sym('y')

__retval__ = ('integer', x_val[1] & y_val[1])
"
end

------------------------------------------------------------------
function bitwise_or
------------------------------------------------------------------
with(x:%integer, y:%integer) do return escape
"
global __retval__
x_val = state.symbol_table.lookup_sym('x')
y_val = state.symbol_table.lookup_sym('y')

__retval__ = ('integer', x_val[1] | y_val[1])
"
end

------------------------------------------------------------------
function bitwise_not
------------------------------------------------------------------
with(x:%integer) do return escape
"
global __retval__
x_val = state.symbol_table.lookup_sym('x')

__retval__ = ('integer', ~x_val[1])
"
end

------------------------------------------------------------------
function bitwise_xor
------------------------------------------------------------------
with(x:%integer, y:%integer) do return escape
"
global __retval__
x_val = state.symbol_table.lookup_sym('x')
y_val = state.symbol_table.lookup_sym('y')

__retval__ = ('integer', x_val[1] ^ y_val[1])
"
end

------------------------------------------------------------------
function bitwise_left_shift
------------------------------------------------------------------
with(x:%integer, y:%integer) do return escape
"
global __retval__
x_val = state.symbol_table.lookup_sym('x')
y_val = state.symbol_table.lookup_sym('y')

__retval__ = ('integer', x_val[1] << y_val[1])
"
end

------------------------------------------------------------------
function bitwise_right_shift
------------------------------------------------------------------
with(x:%integer, y:%integer) do return escape
"
global __retval__
x_val = state.symbol_table.lookup_sym('x')
y_val = state.symbol_table.lookup_sym('y')

__retval__ = ('integer', x_val[1] >> y_val[1])
"
end